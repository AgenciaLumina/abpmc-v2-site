# Implementa√ß√£o R√°pida - Admin Dashboard

## üéØ OBJETIVO
Criar dashboard admin completo para gerenciar todo o conte√∫do do site ABPMC.

---

## ‚úÖ J√Å IMPLEMENTADO

### 1. Dashboard Principal
- ‚úÖ Estat√≠sticas gerais
- ‚úÖ Gr√°ficos de receita
- ‚úÖ Status de associados
- ‚úÖ √öltimas transa√ß√µes
- ‚úÖ Cards informativos

### 2. Estrutura Base
- ‚úÖ Layout admin com sidebar
- ‚úÖ Autentica√ß√£o NextAuth
- ‚úÖ Prote√ß√£o de rotas
- ‚úÖ Banco de dados Prisma

### 3. Dados Migrados
- ‚úÖ 370 posts
- ‚úÖ 34 p√°ginas
- ‚úÖ 722 associados
- ‚úÖ 6 categorias
- ‚úÖ Planos e transa√ß√µes

---

## üöß A IMPLEMENTAR

### FASE 1: Gerenciamento de Conte√∫do (PRIORIT√ÅRIO)

#### 1.1 Posts/Not√≠cias (`/admin/posts`)
```typescript
// Funcionalidades principais:
- Listar posts com pagina√ß√£o
- Criar novo post
- Editar post existente
- Excluir post
- Filtrar por categoria
- Buscar por t√≠tulo
- Alterar status (publish/draft)
- Upload de imagem
```

**API Necess√°ria:**
```typescript
// app/api/admin/posts/route.ts
GET    /api/admin/posts          // Listar
POST   /api/admin/posts          // Criar
PUT    /api/admin/posts/[id]     // Editar
DELETE /api/admin/posts/[id]     // Excluir
```

#### 1.2 P√°ginas (`/admin/conteudos`)
```typescript
// Funcionalidades principais:
- Listar p√°ginas
- Criar nova p√°gina
- Editar p√°gina
- Excluir p√°gina
- Editor WYSIWYG
```

**API Necess√°ria:**
```typescript
// app/api/admin/pages/route.ts
GET    /api/admin/pages          // Listar
POST   /api/admin/pages          // Criar
PUT    /api/admin/pages/[id]     // Editar
DELETE /api/admin/pages/[id]     // Excluir
```

#### 1.3 Categorias (`/admin/categorias`)
```typescript
// Funcionalidades principais:
- Listar categorias
- Criar categoria
- Editar categoria
- Excluir categoria
- Ver posts por categoria
```

---

### FASE 2: Gerenciamento de Usu√°rios

#### 2.1 Associados (`/admin/associados`)
```typescript
// Funcionalidades principais:
- Listar associados com filtros
- Editar dados do associado
- Alterar status
- Resetar senha
- Ver hist√≥rico de pagamentos
- Exportar lista CSV
```

**API Necess√°ria:**
```typescript
// app/api/admin/associados/route.ts
GET    /api/admin/associados              // Listar
GET    /api/admin/associados/[id]         // Detalhes
PUT    /api/admin/associados/[id]         // Editar
POST   /api/admin/associados/[id]/reset   // Reset senha
GET    /api/admin/associados/export       // Exportar CSV
```

#### 2.2 S√≥cios P√∫blicos (`/admin/socios`)
```typescript
// Funcionalidades principais:
- Listar s√≥cios vis√≠veis
- Alterar visibilidade
- Editar informa√ß√µes p√∫blicas
- Ordenar lista
```

---

### FASE 3: Gerenciamento Financeiro

#### 3.1 Transa√ß√µes (`/admin/pagamentos`)
```typescript
// Funcionalidades principais:
- Listar transa√ß√µes
- Filtrar por status/per√≠odo
- Aprovar pagamento
- Rejeitar pagamento
- Ver detalhes
- Gerar relat√≥rio
```

**API Necess√°ria:**
```typescript
// app/api/admin/transacoes/route.ts
GET    /api/admin/transacoes                  // Listar
PUT    /api/admin/transacoes/[id]/aprovar    // Aprovar
PUT    /api/admin/transacoes/[id]/rejeitar   // Rejeitar
GET    /api/admin/transacoes/relatorio       // Relat√≥rio
```

#### 3.2 Planos (`/admin/planos`)
```typescript
// Funcionalidades principais:
- Listar planos
- Criar plano
- Editar plano
- Ativar/desativar
- Ver associados do plano
```

---

### FASE 4: Documentos e Arquivos

#### 4.1 Upload de Documentos (`/admin/documentos`)
```typescript
// Funcionalidades principais:
- Upload de PDFs/DOCs
- Organizar por categoria
- Definir visibilidade
- Download
- Excluir
```

**API Necess√°ria:**
```typescript
// app/api/admin/documentos/route.ts
POST   /api/admin/documentos/upload    // Upload
GET    /api/admin/documentos            // Listar
DELETE /api/admin/documentos/[id]      // Excluir
```

---

### FASE 5: Configura√ß√µes

#### 5.1 Configura√ß√µes Gerais (`/admin/configuracoes`)
```typescript
// Funcionalidades principais:
- Informa√ß√µes do site
- Contato e redes sociais
- SEO global
- Configura√ß√£o de email
- Integra√ß√£o Mercado Pago
- Backup
```

---

## üîß COMPONENTES REUTILIZ√ÅVEIS

### 1. DataTable Component
```typescript
// components/admin/DataTable.tsx
interface DataTableProps {
  columns: Column[];
  data: any[];
  onEdit?: (id: number) => void;
  onDelete?: (id: number) => void;
  pagination?: boolean;
  searchable?: boolean;
}
```

### 2. FormBuilder Component
```typescript
// components/admin/FormBuilder.tsx
interface FormBuilderProps {
  fields: Field[];
  onSubmit: (data: any) => void;
  initialData?: any;
  loading?: boolean;
}
```

### 3. RichTextEditor Component
```typescript
// components/admin/RichTextEditor.tsx
interface RichTextEditorProps {
  value: string;
  onChange: (value: string) => void;
  placeholder?: string;
}
```

### 4. FileUploader Component
```typescript
// components/admin/FileUploader.tsx
interface FileUploaderProps {
  onUpload: (file: File) => void;
  accept?: string;
  maxSize?: number;
  preview?: boolean;
}
```

---

## üìã CHECKLIST DE IMPLEMENTA√á√ÉO

### Gerenciamento de Conte√∫do
- [ ] API de Posts (CRUD completo)
- [ ] P√°gina de listagem de posts
- [ ] Formul√°rio de criar/editar post
- [ ] Upload de imagem para posts
- [ ] API de P√°ginas (CRUD completo)
- [ ] P√°gina de listagem de p√°ginas
- [ ] Formul√°rio de criar/editar p√°gina
- [ ] API de Categorias (CRUD completo)
- [ ] P√°gina de gerenciamento de categorias

### Gerenciamento de Usu√°rios
- [ ] API de Associados (listagem e edi√ß√£o)
- [ ] P√°gina de listagem de associados
- [ ] Formul√°rio de editar associado
- [ ] Fun√ß√£o de reset de senha
- [ ] Exporta√ß√£o CSV
- [ ] P√°gina de s√≥cios p√∫blicos
- [ ] Alterar visibilidade de s√≥cios

### Gerenciamento Financeiro
- [ ] API de Transa√ß√µes
- [ ] P√°gina de listagem de transa√ß√µes
- [ ] Aprovar/rejeitar pagamentos
- [ ] Relat√≥rios financeiros
- [ ] API de Planos
- [ ] P√°gina de gerenciamento de planos
- [ ] Criar/editar planos

### Documentos
- [ ] API de upload de documentos
- [ ] P√°gina de gerenciamento de documentos
- [ ] Upload com drag & drop
- [ ] Organiza√ß√£o por categoria
- [ ] Download de documentos

### Componentes
- [ ] DataTable reutiliz√°vel
- [ ] FormBuilder reutiliz√°vel
- [ ] RichTextEditor (TinyMCE ou similar)
- [ ] FileUploader com preview
- [ ] Modal de confirma√ß√£o
- [ ] StatusBadge
- [ ] LoadingSpinner
- [ ] Toast notifications

### Configura√ß√µes
- [ ] P√°gina de configura√ß√µes gerais
- [ ] Configura√ß√£o de email
- [ ] Configura√ß√£o de pagamento
- [ ] Backup do banco
- [ ] Logs do sistema

---

## üöÄ COMANDOS √öTEIS

### Criar API Route
```bash
# Exemplo: API de Posts
touch app/api/admin/posts/route.ts
```

### Criar P√°gina Admin
```bash
# Exemplo: P√°gina de Posts
touch app/admin/posts/page.tsx
touch app/admin/posts/novo/page.tsx
touch app/admin/posts/[id]/editar/page.tsx
```

### Criar Componente
```bash
# Exemplo: DataTable
touch components/admin/DataTable.tsx
```

---

## üì¶ DEPEND√äNCIAS NECESS√ÅRIAS

```json
{
  "dependencies": {
    "@tanstack/react-table": "^8.10.0",    // Tabelas
    "react-hook-form": "^7.48.0",          // Formul√°rios
    "@tinymce/tinymce-react": "^4.3.0",    // Editor WYSIWYG
    "react-dropzone": "^14.2.3",           // Upload de arquivos
    "react-hot-toast": "^2.4.1",           // Notifica√ß√µes
    "date-fns": "^2.30.0",                 // Manipula√ß√£o de datas
    "xlsx": "^0.18.5",                     // Exportar Excel
    "papaparse": "^5.4.1"                  // Exportar CSV
  }
}
```

---

## üé® DESIGN SYSTEM

### Cores
```css
--admin-bg: #0f172a;          /* Fundo escuro */
--admin-card: #1e293b;        /* Cards */
--admin-border: #334155;      /* Bordas */
--admin-text: #f1f5f9;        /* Texto principal */
--admin-text-muted: #94a3b8;  /* Texto secund√°rio */
--admin-primary: #3b82f6;     /* Azul prim√°rio */
--admin-success: #10b981;     /* Verde sucesso */
--admin-warning: #f59e0b;     /* Amarelo aviso */
--admin-danger: #ef4444;      /* Vermelho erro */
```

### Componentes Base
- Bot√µes: Primary, Secondary, Danger, Ghost
- Inputs: Text, Email, Number, Date, Select, Textarea
- Cards: Com header, body e footer
- Modals: Confirma√ß√£o, Formul√°rio, Visualiza√ß√£o
- Tables: Com ordena√ß√£o, pagina√ß√£o e busca

---

## üìù EXEMPLO DE IMPLEMENTA√á√ÉO

### API de Posts
```typescript
// app/api/admin/posts/route.ts
import { NextRequest, NextResponse } from "next/server";
import { getServerSession } from "next-auth";
import { authOptions } from "@/lib/auth-options";
import { prisma } from "@/lib/prisma";

export async function GET(request: NextRequest) {
  const session = await getServerSession(authOptions);
  
  if (!session || session.user.role !== "ADMIN") {
    return NextResponse.json({ error: "N√£o autorizado" }, { status: 401 });
  }

  const { searchParams } = new URL(request.url);
  const page = parseInt(searchParams.get("page") || "1");
  const limit = parseInt(searchParams.get("limit") || "20");
  const search = searchParams.get("search") || "";
  const categoria = searchParams.get("categoria") || "";

  const where = {
    type: "POST",
    ...(search && {
      OR: [
        { title: { contains: search, mode: "insensitive" } },
        { excerpt: { contains: search, mode: "insensitive" } },
      ],
    }),
    ...(categoria && {
      terms: {
        some: {
          term: {
            slug: categoria,
          },
        },
      },
    }),
  };

  const [posts, total] = await Promise.all([
    prisma.content.findMany({
      where,
      include: {
        terms: {
          include: {
            term: true,
          },
        },
      },
      orderBy: { createdAt: "desc" },
      skip: (page - 1) * limit,
      take: limit,
    }),
    prisma.content.count({ where }),
  ]);

  return NextResponse.json({
    posts,
    pagination: {
      page,
      limit,
      total,
      pages: Math.ceil(total / limit),
    },
  });
}

export async function POST(request: NextRequest) {
  const session = await getServerSession(authOptions);
  
  if (!session || session.user.role !== "ADMIN") {
    return NextResponse.json({ error: "N√£o autorizado" }, { status: 401 });
  }

  const data = await request.json();

  const post = await prisma.content.create({
    data: {
      type: "POST",
      title: data.title,
      slug: data.slug,
      html: data.html,
      excerpt: data.excerpt,
      status: data.status || "draft",
      publishedAt: data.publishedAt ? new Date(data.publishedAt) : null,
      author: session.user.nome,
    },
  });

  // Associar categorias
  if (data.categorias && data.categorias.length > 0) {
    await prisma.contentTerm.createMany({
      data: data.categorias.map((catId: number) => ({
        contentId: post.id,
        termId: catId,
      })),
    });
  }

  return NextResponse.json({ post }, { status: 201 });
}
```

---

## üéØ PR√ìXIMOS PASSOS IMEDIATOS

1. **Instalar depend√™ncias**
   ```bash
   npm install @tanstack/react-table react-hook-form react-hot-toast
   ```

2. **Criar componentes base**
   - DataTable
   - FormBuilder
   - Modal

3. **Implementar APIs**
   - Posts (CRUD)
   - P√°ginas (CRUD)
   - Associados (listagem e edi√ß√£o)

4. **Criar p√°ginas admin**
   - Listagem de posts
   - Formul√°rio de post
   - Listagem de associados

5. **Testar funcionalidades**
   - Criar post
   - Editar post
   - Excluir post
   - Filtrar e buscar

---

**Status:** Planejamento e estrutura criados  
**Data:** 28/10/2025  
**Pr√≥ximo:** Implementa√ß√£o dos componentes e APIs
